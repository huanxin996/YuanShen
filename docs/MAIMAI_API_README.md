# Maimai API æ–‡æ¡£

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç» YuanShen API æ¡†æ¶ä¸­çš„ maimai æ¨¡å—ç›¸å…³æ¥å£ã€‚

## ğŸ® åŠŸèƒ½æ¦‚è¿°

maimai æ¨¡å—æä¾›èˆèŒ DX ç©å®¶æˆç»©ç›¸å…³çš„å¤šç§å›¾ç‰‡ç”Ÿæˆæ¥å£ï¼ŒåŒ…æ‹¬ï¼š

- 8 ç§ä¸åŒç±»å‹çš„ B50 æˆç»©å›¾ç‰‡ç”Ÿæˆ
- å•æ›²æˆç»©æŸ¥è¯¢å’Œç»˜åˆ¶
- å®šæ•°è¡¨å’Œç‰ˆæœ¬è¡¨æŸ¥è¯¢
- ç©å®¶åˆ†æ•°ã€å®šæ•°è¿›åº¦ä¿¡æ¯å±•ç¤º
- å…¨çƒæˆç»©æ•°æ®å±•ç¤º
- ç­‰çº§æˆå°±åˆ—è¡¨æŸ¥è¯¢
- Rating æ’åæŸ¥è¯¢

## ğŸš€ æ¥å£åˆ—è¡¨

### B50 ç³»åˆ—æ¥å£

ä»¥ä¸‹æ‰€æœ‰æ¥å£å‡æ¥å— POST è¯·æ±‚ï¼Œä½¿ç”¨ JSON æ ¼å¼ä¼ å‚ã€‚

| ç«¯ç‚¹                      | æè¿°                 |
|---------------------------|---------------------|
| `/maimai/b50`             | ç”Ÿæˆæ ‡å‡†B50å›¾ç‰‡      |
| `/maimai/bypass50`        | ç”ŸæˆBypass B50å›¾ç‰‡   |
| `/maimai/theoretical50`   | ç”Ÿæˆç†è®ºå€¼B50å›¾ç‰‡     |
| `/maimai/cum50`           | ç”Ÿæˆç§¯åˆ†B50å›¾ç‰‡      |
| `/maimai/abstract50`      | ç”Ÿæˆç®€æ´ç‰ˆB50å›¾ç‰‡     |
| `/maimai/high50`          | ç”Ÿæˆé«˜åˆ†B50å›¾ç‰‡      |
| `/maimai/ap50`            | ç”ŸæˆAPæˆç»©B50å›¾ç‰‡     |
| `/maimai/fc50`            | ç”ŸæˆFCæˆç»©B50å›¾ç‰‡     |

**è¯·æ±‚å‚æ•°ï¼š**

```json
{
  "qq": 12345678,      // ç©å®¶QQå·ï¼ˆå¯é€‰ï¼‰
  "name": "ç©å®¶æ˜µç§°"    // ç©å®¶æ˜µç§°ï¼ˆå¯é€‰ï¼Œqqå’Œnameè‡³å°‘å¡«ä¸€ä¸ªï¼‰
}
```

**æˆåŠŸå“åº”ï¼š**

```json
{
  "returnCode": 1,
  "base64": "base64ç¼–ç çš„å›¾ç‰‡æ•°æ®..."
}
```

### å•æ›²ä¿¡æ¯æŸ¥è¯¢

#### `/maimai/minfo` - æŸ¥è¯¢å•æ›²æˆç»©

**è¯·æ±‚å‚æ•°ï¼š**

```json
{
  "qq": 12345678,        // ç©å®¶QQå·ï¼ˆå¿…å¡«ï¼‰
  "songid": "1050"       // æ­Œæ›²IDæˆ–åç§°ï¼ˆå¿…å¡«ï¼‰
}
```

#### `/maimai/music_info` - æ˜¾ç¤ºè‡ªå®šä¹‰æ­Œæ›²ä¿¡æ¯

**è¯·æ±‚å‚æ•°ï¼š**

```json
{
  "qq": 12345678,        // ç©å®¶QQå·ï¼ˆå¿…å¡«ï¼‰
  "name": "ç©å®¶æ˜µç§°",    // ç©å®¶æ˜µç§°ï¼ˆå½“qqå’ŒnameåŒæ—¶å­˜åœ¨æ—¶ï¼Œä½¿ç”¨qqï¼‰
  "music_data": {        // æ­Œæ›²æ•°æ®å¯¹è±¡ï¼ˆå¿…å¡«ï¼‰
    // æ­Œæ›²è¯¦ç»†ä¿¡æ¯...
  }
}
```

### å®šæ•°å’Œç‰ˆæœ¬è¡¨æŸ¥è¯¢

#### `/maimai/rating_table` - æŸ¥è¯¢å®šæ•°è¡¨

**è¯·æ±‚å‚æ•°ï¼š**

```json
{
  "qq": 12345678,      // ç©å®¶QQå·ï¼ˆå¿…å¡«ï¼‰
  "rating": "14+",     // å®šæ•°å€¼ï¼ˆå¿…å¡«ï¼‰
  "isfc": false        // æ˜¯å¦ä»…æ˜¾ç¤ºFCæˆç»©ï¼ˆå¯é€‰ï¼Œé»˜è®¤falseï¼‰
}
```

#### `/maimai/plate_table` - æŸ¥è¯¢ç‰ˆæœ¬è¡¨

**è¯·æ±‚å‚æ•°ï¼š**

```json
{
  "qq": 12345678,         // ç©å®¶QQå·ï¼ˆå¿…å¡«ï¼‰
  "version": "maimai",    // æ¸¸æˆç‰ˆæœ¬ï¼ˆå¿…å¡«ï¼‰
  "plan": "æ"           // è¯„ä»·ç­‰çº§ï¼ˆå¿…å¡«ï¼‰
}
```

### å…¨çƒæ•°æ®åŠç©å®¶åˆ†æ•°

#### `/maimai/music_global` - æŸ¥è¯¢å…¨çƒæ›²ç›®æ•°æ®

**è¯·æ±‚å‚æ•°ï¼š**

```json
{
  "music_data": {        // æ­Œæ›²æ•°æ®å¯¹è±¡ï¼ˆå¿…å¡«ï¼‰
    // æ­Œæ›²è¯¦ç»†ä¿¡æ¯...
  },
  "level_index": 4       // éš¾åº¦ç­‰çº§ç´¢å¼•ï¼ˆå¿…å¡«ï¼‰
}
```

#### `/maimai/rise_score` - æŸ¥è¯¢åˆ†æ•°æå‡

**è¯·æ±‚å‚æ•°ï¼š**

```json
{
  "qq": 12345678,       // ç©å®¶QQå·ï¼ˆå¿…å¡«ï¼‰
  "name": "ç©å®¶æ˜µç§°",    // ç©å®¶åç§°ï¼ˆå¿…å¡«ï¼‰
  "nickname": "æ˜µç§°",   // ç©å®¶æ˜µç§°ï¼ˆå¯é€‰ï¼‰
  "rating": "14+",      // å®šæ•°å€¼ï¼ˆå¿…å¡«ï¼‰
  "score": "100.5"      // åˆ†æ•°ï¼ˆå¿…å¡«ï¼‰
}
```

### è¿›åº¦ä¸æ’åæŸ¥è¯¢

#### `/maimai/level_process` - æŸ¥è¯¢å®šæ•°è¿›åº¦

**è¯·æ±‚å‚æ•°ï¼š**

```json
{
  "qq": 12345678,       // ç©å®¶QQå·ï¼ˆå¿…å¡«ï¼‰
  "name": "ç©å®¶æ˜µç§°",    // ç©å®¶åç§°ï¼ˆå¯é€‰ï¼‰
  "level": "14+",       // å®šæ•°å€¼ï¼ˆå¿…å¡«ï¼‰
  "plan": "SSS+",       // è¯„ä»·ç­‰çº§ï¼ˆå¿…å¡«ï¼‰
  "category": "default", // åˆ†ç±»ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º"default"ï¼‰
  "page": 1             // é¡µç ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º1ï¼‰
}
```

#### `/maimai/level_achievement_list` - æŸ¥è¯¢ç­‰çº§æˆå°±åˆ—è¡¨

**è¯·æ±‚å‚æ•°ï¼š**

```json
{
  "qq": 12345678,       // ç©å®¶QQå·ï¼ˆå¿…å¡«ï¼‰
  "name": "ç©å®¶æ˜µç§°",    // ç©å®¶åç§°ï¼ˆå¿…å¡«ï¼‰
  "rating": "14+",      // å®šæ•°å€¼ï¼ˆå¿…å¡«ï¼‰
  "page": 1             // é¡µç ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º1ï¼‰
}
```

#### `/maimai/rating_ranking` - æŸ¥è¯¢ratingæ’å

**è¯·æ±‚å‚æ•°ï¼š**

```json
{
  "name": "ç©å®¶æ˜µç§°",    // ç©å®¶åç§°ï¼ˆå¿…å¡«ï¼‰
  "page": 1             // é¡µç ï¼ˆå¿…å¡«ï¼‰
}
```

## ğŸ”§ é”™è¯¯å¤„ç†

æ‰€æœ‰æ¥å£åœ¨å‘ç”Ÿé”™è¯¯æ—¶è¿”å›ç»Ÿä¸€çš„é”™è¯¯æ ¼å¼ï¼š

```json
{
  "returnCode": 100,     // é”™è¯¯ç ï¼š100è¡¨ç¤ºå‚æ•°é”™è¯¯ï¼Œ101è¡¨ç¤ºå†…éƒ¨é”™è¯¯
  "msg": "é”™è¯¯ä¿¡æ¯æè¿°"   // å…·ä½“é”™è¯¯åŸå› 
}
```

å¸¸è§é”™è¯¯ç ï¼š
- `100`: è¯·æ±‚å‚æ•°é”™è¯¯ï¼ˆå¦‚ç¼ºå°‘å¿…è¦å‚æ•°ã€ç”¨æˆ·ä¸å­˜åœ¨ã€æ›²ç›®ä¸å­˜åœ¨ç­‰ï¼‰
- `101`: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼ˆå¦‚ç”Ÿæˆå›¾ç‰‡å¤±è´¥ï¼‰

## ğŸ§© ä½¿ç”¨ç¤ºä¾‹

### ä½¿ç”¨ Python è¯·æ±‚ B50 æ¥å£

```python
import requests
import json
import base64
from PIL import Image
import io

url = "https://your-api-domain.com/maimai/b50"
data = {
    "qq": 12345678,
    "name": "ç©å®¶æ˜µç§°"
}

response = requests.post(url, json=data)
result = response.json()

if result["returnCode"] == 1:
    # å°†Base64å›¾ç‰‡æ•°æ®è½¬ä¸ºå›¾ç‰‡
    img_data = base64.b64decode(result["base64"])
    img = Image.open(io.BytesIO(img_data))
    img.show()  # æ˜¾ç¤ºå›¾ç‰‡
    # æˆ–ä¿å­˜å›¾ç‰‡
    # img.save("b50.png")
else:
    print(f"é”™è¯¯: {result['msg']}")
```

### ä½¿ç”¨ JavaScript è¯·æ±‚æ­Œæ›²ä¿¡æ¯

```javascript
async function getMaiMaiSongInfo() {
    const url = "https://your-api-domain.com/maimai/minfo";
    const data = {
        qq: 12345678,
        songid: "1050"  // ä¹Ÿå¯ä»¥ä½¿ç”¨æ­Œæ›²åç§°
    };
    
    try {
        const response = await fetch(url, {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(data)
        });
        
        const result = await response.json();
        
        if (result.returnCode === 1) {
            // å¤„ç†å›¾ç‰‡æ•°æ®
            const imgElement = document.createElement("img");
            imgElement.src = `data:image/png;base64,${result.base64}`;
            document.body.appendChild(imgElement);
        } else {
            console.error(`è¯·æ±‚å¤±è´¥: ${result.msg}`);
        }
    } catch (error) {
        console.error("è¯·æ±‚å‡ºé”™:", error);
    }
}
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **èµ„æºä¾èµ–**ï¼šæœ¬æ¨¡å—ä¾èµ–äºåŸ [nonebot-plugin-maimaidx](https://github.com/Yuri-YuzuChaN/nonebot-plugin-maimaidx) é¡¹ç›®çš„é™æ€èµ„æºï¼Œè¯·åŠ¡å¿…å°†èµ„æºæ–‡ä»¶æ”¾ç½®åœ¨æ­£ç¡®ä½ç½®
2. **æ°´é±¼Token**ï¼šéƒ¨åˆ†åŠŸèƒ½å¯èƒ½éœ€è¦é…ç½®æœ‰æ•ˆçš„æ°´é±¼Tokenï¼Œè¯·åœ¨ `config.py` ä¸­è®¾ç½®
3. **å‚æ•°éªŒè¯**ï¼šæ‰€æœ‰æ¥å£éƒ½æœ‰ä¸¥æ ¼çš„å‚æ•°éªŒè¯ï¼Œç¡®ä¿æŒ‰è§„å®šæ ¼å¼ä¼ é€’å‚æ•°
4. **å“åº”æ ¼å¼**ï¼šæˆåŠŸå“åº”ç»Ÿä¸€ä¸º `returnCode=1` å¹¶åŒ…å« `base64` å­—æ®µï¼Œå¤±è´¥å“åº”åŒ…å«é”™è¯¯ç å’Œé”™è¯¯ä¿¡æ¯
5. **å›¾ç‰‡å¤„ç†**ï¼šæ‰€æœ‰æ¥å£è¿”å›çš„éƒ½æ˜¯å›¾ç‰‡çš„Base64ç¼–ç ï¼Œéœ€è¦å®¢æˆ·ç«¯è‡ªè¡Œè§£ç æ˜¾ç¤º

## ğŸ“š ç›¸å…³èµ„æº

- [nonebot-plugin-maimaidx](https://github.com/Yuri-YuzuChaN/nonebot-plugin-maimaidx) - æœ¬æ¨¡å—æ”¹é€ è‡ªè¯¥é¡¹ç›®
- [FastAPI æ–‡æ¡£](https://fastapi.tiangolo.com/) - APIæ¡†æ¶æ–‡æ¡£
